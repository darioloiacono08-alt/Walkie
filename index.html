<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Walkie</title>

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="anonymous" />
  <script defer src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
          integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin="anonymous"></script>

  <!-- Favicons optional -->
  <link rel="preload" as="image" href="assets/images/logoapp.png">
  <link rel="preload" as="image" href="assets/images/logotext.png">

  <style>
    :root{
      --bg:#0b1217; --surface:#0f1720; --card:#111c26; --line:#16343a;
      --brand:#19c6ba; --brand-2:#0aa595; --text:#e6f2f0; --muted:#9cd9d3; --danger:#3a171a;
      --shadow: 0 6px 20px rgba(0,0,0,.35);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--text); background:
        radial-gradient(1200px 600px at 50% -10%, rgba(25,198,186,.08), transparent 60%),
        var(--bg);
      font: 16px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      display:flex; flex-direction:column;
    }

    /* HEADER */
    header{
      position:sticky; top:0; z-index:10;
      display:flex; align-items:center; gap:.7rem; padding: .8rem 1rem;
      background: linear-gradient(180deg, #0b141a, #0b1217);
      border-bottom:1px solid #0f2a2c;
    }
    .brand{display:flex; align-items:center; gap:.5rem}
    .brand img.logo{height:30px}
    .brand img.text{height:20px; opacity:.95}
    .goal{
      margin-left:auto; display:flex; align-items:center; gap:.45rem;
      padding:.35rem .6rem; border-radius:999px; background:rgba(25,198,186,.12);
      border:1px solid #1b6a67; font-size:.9rem;
    }
    .goal img{height:18px}

    /* CONTENT */
    main{flex:1; padding: .75rem; padding-bottom: 76px; /* space for bottom bar */ }
    .section{display:none}
    .section.active{display:block}

    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      padding:.9rem;
    }

    /* MAP */
    #map{height:55vh; border-radius:14px; overflow:hidden; border:1px solid var(--line)}
    .toolbar{display:flex; gap:.55rem; margin:.65rem 0 .2rem}
    .btn{
      display:flex; align-items:center; gap:.5rem; padding:.7rem 1rem; border-radius:14px;
      background:var(--surface); border:1px solid var(--line); color:var(--text);
    }
    .btn img{height:22px}
    .btn:active{transform:translateY(1px)}
    .btn.primary{
      background:linear-gradient(180deg,var(--brand),var(--brand-2));
      border-color:#0d7a72; color:#032d2a; font-weight:700;
    }
    .btn.stop{background:var(--danger); border-color:#5a2d2f; opacity:.9}
    .metrics{display:grid; grid-template-columns:repeat(3,1fr); gap:.55rem; margin-top:.4rem}
    .metric{padding:.8rem; text-align:center; border-radius:14px; border:1px solid var(--line); background:var(--surface)}
    .metric .v{font-size:1.35rem; font-weight:800}

    .center{display:flex; justify-content:center}
    .hint{font-size:.9rem; opacity:.8}

    /* HEALTH */
    .form{display:grid; gap:.6rem}
    .row{display:grid; grid-template-columns:1fr 1fr; gap:.6rem}
    label{font-size:.9rem; opacity:.95}
    input, select{
      width:100%; padding:.6rem .7rem; border-radius:12px; background:#0a1319; color:var(--text);
      border:1px solid #294a4e;
    }
    .result{display:flex; align-items:center; gap:.8rem; margin-top:.6rem}
    .result img{height:42px}

    /* HISTORY */
    .list{display:grid; gap:.6rem}
    .item{display:grid; grid-template-columns:1fr auto; gap:.6rem; align-items:center;
      padding:.7rem; border-radius:14px; border:1px solid var(--line); background:var(--surface)
    }
    .muted{opacity:.75}

    /* BOTTOM NAV */
    .bottom{
      position:fixed; left:0; right:0; bottom:0; z-index:20; backdrop-filter: blur(10px);
      padding:.5rem .6rem .7rem; background:rgba(6,10,14,.7); border-top:1px solid #0f2a2c;
    }
    .tabs{display:grid; grid-template-columns:repeat(4,1fr); gap:.5rem}
    .tab{
      display:flex; flex-direction:column; align-items:center; gap:.25rem;
      padding:.5rem .3rem; border-radius:14px; background:transparent; border:1px solid transparent; color:var(--muted);
    }
    .tab.active{border-color:#1b6a67; background:rgba(25,198,186,.08); color:var(--text)}
    .tab img{height:22px}
    .tab span{font-size:.78rem}

    /* Safe areas */
    @supports (padding: max(0px)) {
      .bottom { padding-bottom: max(.7rem, env(safe-area-inset-bottom)); }
      header { padding-top: calc(.8rem + env(safe-area-inset-top) * .0); }
    }

    @media (min-width: 760px){
      #map{height:58vh}
      .metrics{grid-template-columns:repeat(6,1fr)}
      .row{grid-template-columns:repeat(3,1fr)}
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <img class="logo" src="assets/images/logoapp.png" alt="Walkie logo"/>
      <img class="text" src="assets/images/logotext.png" alt="Walkie"/>
    </div>
    <div class="goal" aria-live="polite">
      <img src="assets/images/dailygoal.png" alt="" />
      <span id="goalLabel">Goal: 2.0 km</span>
    </div>
  </header>

  <main>
    <!-- Passeggiata -->
    <section id="s-walk" class="section active">
      <div class="card">
        <div id="map" role="application" aria-label="Mappa passeggiata"></div>
        <div class="toolbar">
          <button id="startBtn" class="btn primary"><img src="assets/images/startwalk.png" alt="">Start</button>
          <button id="stopBtn" class="btn stop" disabled><img src="assets/images/stopwalk.png" alt="">Stop</button>
          <button id="centerBtn" class="btn"><img src="assets/images/position.png" alt="">Centra</button>
        </div>

        <div class="metrics">
          <div class="metric"><div class="k">Distanza</div><div id="mDist" class="v">0.00 km</div></div>
          <div class="metric"><div class="k">Durata</div><div id="mTime" class="v">00:00</div></div>
          <div class="metric"><div class="k">Velocità</div><div id="mSpeed" class="v">0.0 km/h</div></div>
          <div class="metric"><div class="k">Media 1km</div><div id="mPace" class="v">—</div></div>
          <div class="metric"><div class="k">Goal</div><div id="mGoal" class="v">0%</div></div>
          <div class="metric"><div class="k">Sessioni</div><div id="mCount" class="v">0</div></div>
        </div>

        <p class="center"><img src="assets/images/walkingdog.png" alt="" style="height:56px; opacity:.95"></p>
        <p class="hint">Suggerimento: per precisione migliore, resta all’aperto e attendi il fix GPS.</p>
      </div>
    </section>

    <!-- Salute -->
    <section id="s-health" class="section">
      <div class="card">
        <h3 style="margin:0 0 .6rem">Indice di Salute</h3>
        <div class="form">
          <div class="row">
            <label>Età (anni)<br><input id="age" type="number" min="0" step="0.1" value="4"></label>
            <label>Peso (kg)<br><input id="weight" type="number" min="0" step="0.1" value="18"></label>
          </div>
          <div class="row">
            <label>Attività giornaliera (min)<br><input id="mins" type="number" min="0" step="1" value="45"></label>
            <label>BCS (1-9)<br>
              <select id="bcs">
                <option>3</option><option>4</option><option selected>5</option>
                <option>6</option><option>7</option><option>8</option><option>9</option>
              </select>
            </label>
          </div>
          <div class="row">
            <label>Riposo notturno (ore)<br><input id="sleep" type="number" min="0" max="20" step="0.5" value="12"></label>
            <label>HR a riposo (bpm)<br><input id="hr" type="number" min="30" max="180" step="1" value="80"></label>
          </div>
          <button id="calcBtn" class="btn primary" style="width:max-content">Calcola punteggio</button>
          <div id="healthOut" class="result" aria-live="polite"></div>
        </div>
      </div>
    </section>

    <!-- Storico -->
    <section id="s-history" class="section">
      <div class="card">
        <h3 style="margin:0 0 .6rem">Storico passeggiate</h3>
        <div id="history" class="list"></div>
      </div>
    </section>

    <!-- Impostazioni -->
    <section id="s-settings" class="section">
      <div class="card">
        <h3 style="margin:0 0 .6rem">Impostazioni</h3>
        <label>Goal giornaliero (km)
          <input id="goalKm" type="number" min="0" step="0.1" value="2.0" />
        </label>
        <p class="muted">Il goal viene salvato in locale e mostra l’avanzamento nella schermata Passeggiata.</p>
      </div>
    </section>
  </main>

  <!-- Bottom navigation -->
  <nav class="bottom" aria-label="Navigazione inferiore">
    <div class="tabs">
      <button class="tab active" data-target="s-walk">
        <img src="assets/images/mapssection.png" alt=""><span>Passeggiata</span>
      </button>
      <button class="tab" data-target="s-health">
        <img src="assets/images/dogsection.png" alt=""><span>Salute</span>
      </button>
      <button class="tab" data-target="s-history">
        <img src="assets/images/trophy.png" alt=""><span>Storico</span>
      </button>
      <button class="tab" data-target="s-settings">
        <img src="assets/images/settings.png" alt=""><span>Impostazioni</span>
      </button>
    </div>
  </nav>

  <script defer src="app.js"></script>
</body>
</html>
